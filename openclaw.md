OpenClaw セキュリティ：v2026.2.12〜2.15で何が変わったのか

■ 1. ✅ アプデで解決済みの脆弱性 🟢

  ▸ 1.1 リモートコード実行（RCE）経路の遮断
    • 問題：ブラウザ制御のループバックが認証なしで動作→ワンクリックRCE＆トークン窃取が可能だった
    • 修正（v2.12）：ループバック経由のブラウザ制御に認証必須化。未設定時はGatewayトークンを自動生成
    • 現状：この経路からのRCEはパッチ適用済みインスタンスでは塞がれた

  ▸ 1.2 SSRF（サーバーサイドリクエストフォージェリ）
    • 問題：エージェントを騙して内部ネットワークをスキャン・探索させることが可能だった
    • 修正（v2.12）：input_file/input_imageに明示的SSRF拒否ポリシー＋ホスト名許可リスト＋リクエスト上限＋監査ログを実装
    • 現状：解決済み

  ▸ 1.3 未認証リモート設定改ざん
    • 問題：Nostrプロファイル APIで認証なしにエージェント設定を変更可能だった
    • 修正（v2.12）：パッチ適用済み
    • 現状：解決済み

  ▸ 1.4 セッションハイジャック
    • 問題：POST /hooks/agentでsessionKeyを上書きして他人のセッションに侵入可能だった
    • 修正（v2.12）：デフォルトでsessionKeyオーバーライドを拒否に変更
    • 現状：解決済み（レガシー動作が必要な場合は明示的opt-in）

  ▸ 1.5 スキル経由のディレクトリトラバーサル
    • 問題：スキルのfrontmatter制御名をファイルシステムパスとして使い、サンドボックス外に書き込み可能だった
    • 修正（v2.12）：ミラー先をskills/ルートに限定
    • 追加修正（v2.15）：スキルインストーラーのtargetDirもスキル専用ディレクトリに制限
    • 現状：解決済み

  ▸ 1.6 Webコンテンツ経由のプロンプトインジェクション再送攻撃
    • 問題：ブラウザ/Webツールの出力がそのままLLMコンテキストに入り、悪意あるWeb上の隠し命令が実行された
    • 修正（v2.12）：ブラウザ/Webコンテンツを「デフォルト非信頼」に変更。構造化メタデータでラップし、toolResult.detailsをモデル入力から除去
    • 現状：大幅改善（ただしプロンプトインジェクション自体は完全解決不可能→後述）

  ▸ 1.7 コンテナエスケープ防止
    • 問題：サンドボックスのDocker設定でバインドマウント・ホストネットワーク・seccomp/apparmor無効化が可能だった
    • 修正（v2.15）：危険なDocker設定をブロック。SHA-1→SHA-256へ移行
    • 現状：解決済み

  ▸ 1.8 情報漏洩の防止
    • 問題：Telegramボットトークンがログに露出、非管理者にセッション詳細が見えていた
    • 修正（v2.15）：トークンの秘匿、非管理者向けセッション/パス情報の除去
    • 現状：解決済み

  ▸ 1.9 XSS・インジェクション系
    • 問題：Control UIでstored XSS、chat.sendでnullバイト/制御文字の注入が可能
    • 修正（v2.15）：script-src 'self'強制、JSON配信化、制御文字除去、Unicode NFC正規化
    • 現状：解決済み

  ▸ 1.10 ワークスペースパス経由のプロンプトインジェクション
    • 問題：悪意あるディレクトリ名にUnicode制御文字を仕込み、LLMプロンプトに命令を注入可能だった
    • 修正（v2.15）：パス埋め込み前にUnicode制御/書式文字を除去
    • 現状：この経路は塞がれた

■ 2. 🟡 改善されたが完全ではない領域

  ▸ 2.1 ClawHubの悪意あるスキル問題
    • 過去：全スキルの約20%（約900個）が悪意あるものだった（Bitdefender調査）
    • 対応済み：2026年2月にVirusTotalと提携し3,016スキルを自動分析、悪意あるスキルを削除
    • 残る課題：GitHubリポジトリに初期スキルのコピーが残存→二次配布リスクあり。npm lifecycleスクリプトによるインストール時コード実行も依然リスク
    • 評価：大幅改善だが「スキル＝信頼できないコード」の前提は変わらない

  ▸ 2.2 localhost信頼バイパス
    • 過去：リバースプロキシ経由の接続がすべて127.0.0.1に見え、認証バイパスが可能だった
    • 対応済み（v2.12〜）：trustedProxies設定の導入。プロキシヘッダーが信頼リスト外からの場合はローカル扱いしない
    • 残る課題：ユーザーが正しく設定しないと依然バイパス可能。設定ミスによる脆弱性は構造的に防げない
    • 評価：ツールは揃ったが、ユーザーの設定次第

  ▸ 2.3 WebSocket接続の保護
    • 過去：任意のオリジンからWebSocket接続が可能だった
    • 対応済み：Gateway認証がデフォルト必須化（未設定時はfail-closed）
    • 残る課題：認証トークンの強度・管理はユーザー依存
    • 評価：デフォルトが安全側に倒れたのは大きな進歩

  ▸ 2.4 CJK検索の改善
    • 過去：日本語等の非ASCII検索がベクトル検索のみにフォールバック
    • 修正（v2.15）：buildFtsQueryがUnicode対応に
    • 残る課題：セキュリティ直結ではないが、メモリ検索の精度がエージェントの判断品質に影響
    • 評価：日本語ユーザーにとって実用面で大きな改善

■ 3. ❌ 構造的に残るリスク（アプデでは解決不可能） 🔴

  ▸ 3.1 「致命的三重苦」は設計上の特性
    • プライベートデータアクセス＋非信頼コンテンツ曝露＋外部通信能力の3つが揃う構造はOpenClawの機能そのもの
    • パッチで直せる種類の問題ではない→「爆発半径（blast radius）を最小化する」アプローチしかない

  ▸ 3.2 プロンプトインジェクションは根本未解決
    • v2.12でWebコンテンツの非信頼化、v2.15でパス経由の注入防止は実装済み
    • しかし「AIモデルがデータと命令を区別できない」という根本問題は業界全体で未解決
    • 公式もOpus 4.6推奨＋サンドボックス＋ツール制限で「被害を限定する」方針

  ▸ 3.3 デフォルト設定のまま使うユーザーの問題
    • 13万5千超のインスタンスがインターネットに露出（SecurityScorecard調査）
    • パッチが出てもアプデしなければ意味がない
    • OpenClaw側の問題というより運用側の問題だが、現実の脅威として大きい

  ▸ 3.4 組織体制の課題
    • 2026年2月時点でバグバウンティプログラムなし、専任セキュリティチームなし
    • コミュニティ貢献者40名超の活発さはあるが、体系的なセキュリティレビュー体制は未整備
    • OSSとしての透明性はあるが、企業利用には信頼性の面でギャップあり

■ 4. 📊 総合評価マトリクス

    RCE経路　　　　　：v2.12で修正 ✅
    SSRF　　　　　　 ：v2.12で修正 ✅
    セッション乗っ取り ：v2.12で修正 ✅
    XSS/インジェクション：v2.15で修正 ✅
    コンテナエスケープ ：v2.15で修正 ✅
    情報漏洩（ログ）　 ：v2.15で修正 ✅
    ClawHub悪意スキル ：大幅改善 🟡（残存リスクあり）
    localhost信頼バイパス：改善 🟡（設定依存）
    プロンプトインジェクション：軽減のみ 🟡（根本未解決）
    致命的三重苦　　　：構造的課題 ❌（設計上の特性）
    運用/設定ミス　　 ：ユーザー依存 ❌（ツールは提供済み）
    組織体制　　　　　：未整備 ❌

🔑 結論：v2.12〜2.15のアプデで「既知の具体的な攻撃経路」はかなり塞がれた。特にRCE・SSRF・セッションハイジャック・XSSといった重大な脆弱性はパッチ済み。ただし「AIエージェントが強い権限を持つ」という構造的リスクとプロンプトインジェクションは、OpenClawに限らず業界全体の課題。「アプデしたから安全」ではなく「アプデ＋正しい設定＋最小権限の原則＋継続的な監査」がセットで必要かなと。逆に言えば、ここまでセキュリティ修正に本気で取り組んでるOSSエージェントフレームワークは珍しいとも思う🦞🔐

GitHub - OpenClaw Releases
　　URL: https://github.com/openclaw/openclaw/releases
OpenClaw Security Documentation
　　URL: https://docs.openclaw.ai/gateway/security
Adversa AI - OpenClaw Security Guide
　　URL: https://adversa.ai/blog/openclaw-security-101-vulnerabilities-hardening-2026/

